select [AgentPaymentID],[PayDate],[Number],[StatusDate],
LEFT(CAST([ExtraParams].query('data(r/trm_prv_id)') as  nvarchar(max)),10)+RIGHT('0000000000'+cast(AgentTerminalID as varchar(10)),10)  trm_prv_id,
CAST([ExtraParams].query('data(r/creditid)') as nvarchar) creditid,
CAST([ExtraParams].query('data(r/em_bd)') as nvarchar) em_bd,[PaySum],[ProviderSum] --,[ExtraParams]
from [dbo].[Payment] p with (nolock) join
Service s with (nolock) on p.ServiceID=s.ServiceID
where status=2 and StatusDate>='2022-04-21' and p.ServiceID =576
