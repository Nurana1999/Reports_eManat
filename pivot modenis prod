

select * from
(
select osmpproviderid,s.servicename,format(paydate,'MMM','en-US') as tarix,paysum from 
payment p with (nolock) join service s with (nolock)  on p.serviceid =s.serviceid where 
agentterminalid not in (4244,4245,4702) and paydate between '2022-01-01' and '2022-07-01' and status=2 
and CAST([ExtraParams].query('data(r/agt_id)') as nvarchar(max)) <>'3'
) t 
pivot 
(sum(paysum) for tarix in ("Jan","Feb","Mar","Apr","May","Jun")) as p_table
