select q.id_operation,q.id_service,id_point,account,time_point,time_server,time_process, cast(sum_income as numeric)/100 sum_income,
cast(sum_outcome as numeric)/100 sum_outcome,tran.value as trans,pan.value as pan ,accno.value as accno,fn.value as fullname ,uid.value as objectid
from reckon.work_master q
join reckon.work_services s on q.id_service =s.id_service 
left join
(select id_operation,value from reckon.work_operation_attributes where name ='trans' )  tran on q.id_operation =tran.id_operation 
left join
(select id_operation,value from reckon.work_operation_attributes where name ='pan' )  pan on q.id_operation =pan.id_operation 
left join
(select id_operation,value from reckon.work_operation_attributes where name ='accountNumber' )  accno  on q.id_operation =accno.id_operation 
left join
(select id_operation,value from reckon.work_operation_attributes where name ='customerFullName' ) fn on q.id_operation =fn.id_operation 
left join
(select id_operation,value from reckon.work_operation_attributes where name ='uid' ) uid on q.id_operation =uid.id_operation 
where q.id_service in (1584)
and  q.state = 60    
       and q.substate = 0
        and q.time_process >= '2022-05-01' 
       and q.time_process < '2022-05-15' 
       and q.time_server >= date '2022-05-01' - interval '7day'
       and q.time_server < date '2022-05-15' + interval '7day'
