select q.id_operation,q.id_service,id_point,account,time_point,time_server,time_process, cast(sum_income as numeric)/100 sum_income,
cast(sum_outcome as numeric)/100 sum_outcome,tran.value as trans,pin.value as pin ,cno.value as cust_no,fn.value as fullname ,ob.value as objectid
from operations.master q
join public.services s on q.id_service =s.id_service 
left join
(select id_operation,value from public.operation_attributes where name ='trans' )  tran on q.id_operation =tran.id_operation 
left join
(select id_operation,value from public.operation_attributes where name ='pin' )  pin on q.id_operation =pin.id_operation 
left join
(select id_operation,value from public.operation_attributes where name ='cust_ac_no' )  cno  on q.id_operation =cno.id_operation 
left join
(select id_operation,value from public.operation_attributes where name ='fullname' ) fn on q.id_operation =fn.id_operation 
left join
(select id_operation,value from public.operation_attributes where name ='objectId' ) ob on q.id_operation =ob.id_operation 
where q.id_service in (1579,1580,1581)
and  q.state = 60    
       and q.substate = 0
        and q.time_process >= '2022-05-20' 
       and q.time_process < '2022-06-01' 
       and q.time_server >= date '2022-05-20' - interval '7day'
       and q.time_server < date '2022-06-01' + interval '7day'
       
